id: storageTestFailed
args:
  - name: operation
    type: Atom
x-erl-to_json: |
  to_json(Error = ?ERR_STORAGE_TEST_FAILED(Operation)) ->
      #{
          <<"id">> => ?ERR_STORAGE_TEST_FAILED_ID,
          <<"details">> => #{<<"operation">> => str_utils:to_binary(Operation)},
          <<"description">> => od_error:format_description("Failed to ~ts test file on storage.", [Operation]),
          <<"context">> => od_error:encode_error_ctx(Error)
      }.
x-erl-from_json: |
  from_json(ErrorJson = #{<<"id">> := ?ERR_STORAGE_TEST_FAILED_ID, <<"details">> := #{<<"operation">> := Operation}}) when
      Operation == <<"read">>;
      Operation == <<"write">>;
      Operation == <<"remove">>
  ->
      ErrorCtx = od_error:decode_error_ctx(ErrorJson),
      ?ERR_STORAGE_TEST_FAILED(ErrorCtx, binary_to_atom(Operation, utf8)).
description: >-
  Failed to {operation} test file on storage.
http_code: 400
errno: EIO
